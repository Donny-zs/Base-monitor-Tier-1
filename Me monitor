local component = require("component")
local term = require("term")

local refresh = 1  --время в секундах, через которое прозойдёт проверка МЕ системы
local interface = component.me_interface  
local chatbox = component.chat_box
Cpus = interface.getCpus()
CpusMem = interface.getCpus()

local function SayIfAeDone()
Cpus=interface.getCpus()
  for i=1,#Cpus do
    if Cpus[i]["busy"] ~= CpusMem[i]["busy"]
    then chatbox.say("Ячейка крафта "..Cpus[i]["name"].." изменила состояние") end
    CpusMem=interface.getCpus()
    end
  end
end

component.gpu.setResolution(8,5)
term.clear()
term.setCursor(1,1)
print("Текущее потребление МЕ:\n")

local function AeEuConsumption()
  term.clearLine()
  local pow = interface.getAvgPowerInjection()
  pow = pow*0.5 -- конвертация из ае в еу
  term.write(math.floor(pow)) -- округление до целого
  term.write(" EU")
end

while true do
AeEuConsumption()
SayIfAeDone()
os.sleep(refresh)
end
